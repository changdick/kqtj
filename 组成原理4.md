# 组成原理4 总线和IO
## 总线
### 总线控制
总线控制中分为总线判优控制和总线通信控制。
#### 总线判优控制
总线判优控制分为集中式和分布式，集中式中的三种方式：链式查询方式，计数器定时查询方式、独立请求方式。  

**链式查询方式**：三条控制线，BR、BS、和BG，设备有请求时向总线控制部件发总线请求BR，总线控制部件通过总线同意信号BG依次查询（链式，顺序固定）各个设备，当到达第一个有请求的设备，就发出总线忙信号BS，该设备获得总线控制权。**优先级固定**，**单点故障敏感**，响应慢，优先级低的设备很难获得请求，容易扩充。  
**计数器定时查询方式**：和链式查询一样有BR和BS，没有BG而是增加了设备地址线，**设备地址线的根数** $log_2n$向上取整。优先级可变，对电路故障不敏感，控制较复杂。  
**独立请求方式**：每个设备都有各自的BR和BG，独立发送请求，**响应速度快**，在总线控制部件内部进行排队逻辑，**优先级灵活**。但要用2n根控制线。

#### 总线通信控制
总线通信控制方式为了解决通信双⽅如何协调配合的问题。  
总线周期：完成⼀次总线操作的时间。分为四个阶段： 申请阶段、寻址阶段、传输阶段、结束阶段。   
通信的四种方式：同步通信、异步通信、半同步通信、分离式通信。
1. 同步通信：双方由**统一时标**控制数据传送。（仅适合于总线长度短，各功能模块存取时间相差不大的情况，必须按最慢的设备定时）。
2. 异步通信：采⽤应答方式（握手方式），有不互锁方式、半互锁方式、全互锁方式三种。
3. 半同步通信：有统一时标，同时从模块可以给出wait信号给主模块，由于等待信号的存在，允许不同速度的模块和谐工作。
4. 分离式通信：**充分挖掘系统总线每个瞬间的潜力**。
